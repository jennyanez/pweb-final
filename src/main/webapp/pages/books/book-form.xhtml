<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:p="http://primefaces.org/ui">

	<p:dialog header="Book" showEffect="fade" modal="true"
		widgetVar="manageBookDialog" responsive="true">
		<p:outputPanel id="manage-book-content" class="ui-fluid">
	  	<p:outputPanel rendered="#{not empty manageBookBean.selectedBook}"> 	
				<p:panelGrid layout="grid" columns="2">
					<h:panelGroup>
												
                    <div class="p-field">
							<p:outputLabel for="@next">ISBN Code</p:outputLabel>
							<p:inputText id="code" required="true" 
								value="#{manageBookBean.selectedBook.bookCode}" />
							<p:message for="@previous" ></p:message>
						</div>
						
                        <div class="p-field">
							<p:outputLabel for="@next">Title</p:outputLabel>
							<p:inputText id="title" required="true"
								value="#{manageBookBean.selectedBook.bookTitle}" />
							<p:message for="@previous"></p:message>
						</div>
					
                        <div class="p-field">
							<p:outputLabel for="@next">Year Edition</p:outputLabel>
							<p:spinner id="rotate" value="#{manageBookBean.selectedBook.yearEdition}" min="1" max="2022" rotate="true"/>
							<p:message for="@previous"></p:message>
						</div>

						<!--editorial-->
						<div class="p-field">
							<p:outputLabel for="@next">Editorial</p:outputLabel>
							<p:inputText id="editorial"
										 value="#{manageBookBean.selectedBook.editorial}" />
							<p:message for="@previous"></p:message>
						</div>

						<!--Authors-->
						<div class="p-field">
							<p:outputLabel for="@next">Authors</p:outputLabel>
							<p:selectCheckboxMenu id="authors"
												  value="#{manageBookBean.selectedAuthors}"
												  label="Select the authors"
												  style="min-width: 15rem"
												  multiple="true"
												  filter="true"
												  filterMatchMode="startsWith"
												  panelStyle="width: 30rem"
												  scrollHeight="250"
												  emptyLabel="Please select..."
												  updateLabel="true"
												  required="true">
								<!--							<p:ajax event="itemUnselect" listener="#{checkboxView.onItemUnselect}"/>-->
								<f:selectItems value="#{manageBookBean.authors}"
											   var="author"
											   itemLabel="#{author.name}" itemValue="#{author.authorId}"/>
							</p:selectCheckboxMenu>
						</div>

					</h:panelGroup>
					<h:panelGroup>
						<!--country-->
						<div class="p-field">
							<p:outputLabel for="@next">Country Origin</p:outputLabel>
							<p:selectOneMenu id="country-origin"
											 value="#{manageBookBean.selectedBook.countryOrigin}"
											 converter="#{countryConverter}"
											 panelStyle="width:180px"
											 effect="fade" var="c"
											 filter="true" filterMatchMode="startsWith">

								<f:selectItems value="#{selectOneMenuView.countries}" var="country"
											   itemLabel="#{country.name}" itemValue="#{country}"/>

								<p:column style="width:10%">
									<span class="flag flag-#{c.code}" style="width: 30px; height: 20px"/>
								</p:column>

								<p:column>
									<f:facet name="header">
										<h:outputText value="Name"/>
									</f:facet>
									<h:outputText value="#{c.name}"/>
								</p:column>

								<f:facet name="footer">
									<h:outputText value="#{selectOneMenuView.countries.size()} countries"
												  style="font-weight:bold;" styleClass="py-1 block"/>
								</f:facet>
							</p:selectOneMenu>
						</div>
						<!--fin de countries -->


						<!--Amount pages-->
						<div class="p-field">
							<p:outputLabel for="@next">Amount of pages</p:outputLabel>
							<p:inputNumber id="pages"
										   value="#{manageBookBean.selectedBook.amountPages}"
										   minValue="1"
										   decimalPlaces="0" />
							<p:message for="@previous"></p:message>
						</div>
						<!--Materia-->
						<div class="p-field">
							<p:outputLabel for="@next">Matter</p:outputLabel>
							<p:selectOneMenu
									id="matter"
									required="true"
									label="Seleccione"
									value="#{manageBookBean.selectedMatter}"
									style="min-width: 15rem"
									multiple="true"
									filter="true"
									filterMatchMode="startsWith"
									panelStyle="width: 30rem"
									scrollHeight="250">
								<f:selectItem itemLabel="Select a matter" itemValue="#{null}" noSelectionOption="true"/>
								<f:selectItems value="#{manageBookBean.matters}" var="matter" required="true"
											   itemValue="#{matter.matterId}" itemLabel="#{matter.matterName}"/>
							</p:selectOneMenu>
							<p:message for="@previous" ></p:message>
						</div>

						<!--amount of copies-->
						<div class="p-field">
							<p:outputLabel for="@next" value="Amount of new copies"/>
							<p:spinner id="copies" value="#{manageBookBean.amountCopies}" min="0"/>
						</div>

						<!-- book summary -->
						<div class="p-field">
							<p:outputLabel for="@next">Book summary</p:outputLabel>
							<p:inputTextarea rows="5" cols="30" counter="display" maxlength="180"
											 counterTemplate="{0} characters remaining." autoResize="false"/>
							<h:outputText id="display" class="block" />
						</div>

					</h:panelGroup>
				</p:panelGrid>
		 	</p:outputPanel> 
		</p:outputPanel>

		<f:facet name="footer">
			<p:commandButton value="Salvar" icon="pi pi-check"
				actionListener="#{manageBookBean.saveBook}"
				update="manage-book-content" process="manage-book-content @this"/>
			<p:commandButton value="Cancelar" icon="pi pi-times"
				onclick="PF('manageBookDialog').hide()" class="ui-button-secondary"/>
		</f:facet>
	</p:dialog>
</ui:composition>